FROM node:8-slim

RUN apt-get update && apt-get install -y cron git
EXPOSE 80

# Get flavor-builder
WORKDIR /git/flavor-builder
COPY package.json package.json
RUN npm i && rm -rf /root/.npm /usr/local/share/.cache /root/.cache

COPY crontab /etc/cron.d/flavor-cron
RUN chmod 744 /etc/cron.d/flavor-cron

COPY start.sh /start.sh
RUN chmod 744 /start.sh

COPY on-tabs-config.json /on-tabs-config.json
COPY flavor-config.json /flavor-config.json

CMD /start.sh
